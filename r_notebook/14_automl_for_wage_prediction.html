

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>14. AutoML for wage prediction &#8212; Inference on Causal and Structural Parametters Using ML and AI</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'r_notebook/14_automl_for_wage_prediction';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="15. Functional Approximation By NN and RF" href="15_functional_approximation_by_nn_and_rf.html" />
    <link rel="prev" title="13. Deep Neural Networks for Wage Prediction" href="13_deep_neural_networks_for_wage_prediction.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/main_logo_ai_light.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/main_logo_ai_light.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01_r_notebook_linear_model_overfiting.html">1. Linear Model Overfiting</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_ols_and_lasso_for_wage_prediction.html">2. OLS and lasso for wage prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_ols_and_lasso_for_gender_wage_gap_inference.html">3. OLS and lasso for gender wage gap inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_r_notebook_some_rct_examples.html">4. Some RCT Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_r_notebook_analyzing_rct_with_precision.html">5. Analyzing RCT reemployment experiment with Precision by Ajusting for Baseline Covariates</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_analyzing_rct_reemployment_experiment.html">6. Analyzing RCT reemployment experiment</a></li>
<li class="toctree-l1"><a class="reference internal" href="07_r_notebook_linear_penalized_regs.html">7. Linear Penalized Regs</a></li>
<li class="toctree-l1"><a class="reference internal" href="08_ml_for_wage_prediction.html">8. ML for wage prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="09_r_notebook_experiment_on_orthogonal_learning.html">9. Experiment on orthogonal Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="10_double_lasso_for_the_convergence_hypothesis.html">10. Double Lasso for the convergence hypothesis</a></li>
<li class="toctree-l1"><a class="reference internal" href="11_heterogenous_wage_effects.html">11. Heterogenous Wage Effects</a></li>
<li class="toctree-l1"><a class="reference internal" href="12_r_colliderbias_hollywood.html">12. ColliderBias Hollywood</a></li>
<li class="toctree-l1"><a class="reference internal" href="13_deep_neural_networks_for_wage_prediction.html">13. Deep Neural Networks for Wage Prediction</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">14. AutoML for wage prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="15_functional_approximation_by_nn_and_rf.html">15. Functional Approximation By NN and RF</a></li>
<li class="toctree-l1"><a class="reference internal" href="16_notebook_dagitty.html">16. Notebook-DAGitty</a></li>
<li class="toctree-l1"><a class="reference internal" href="17_notebook_dosearch.html">17. Notebook-Dosearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="18_dml_inference_for_gun_ownership.html">18. DML inference for gun ownership</a></li>
<li class="toctree-l1"><a class="reference internal" href="19_dml_inference_using_nn_for_gun_ownership.html">19. DML inference using NN for gun ownership</a></li>
<li class="toctree-l1"><a class="reference internal" href="20_pm5_401k.html">20. DML for ATE and LATE of 401(k) on Wealth</a></li>
<li class="toctree-l1"><a class="reference internal" href="21_identification_analysis_of_401_k_example_w_dags.html">21. Debiased ML for Partially Linear Model in R</a></li>
<li class="toctree-l1"><a class="reference internal" href="22_debiased_ml_for_partially_linear_model_in_r.html">22. Debiased ML for Partially Linear Model in R</a></li>
<li class="toctree-l1"><a class="reference internal" href="23_sensitivity_analysis_with_sensmakr_and_debiased_ml.html">23. Sensitivity Analysis with Sensmakr and Debiased ML</a></li>
<li class="toctree-l1"><a class="reference internal" href="24_debiased_ml_for_partially_linear_iv_model_in_r.html">24. Debiased ML for Partially Linear IV Model in R</a></li>
<li class="toctree-l1"><a class="reference internal" href="25_r_weak_iv_experiments.html">25. Weak IV Experiments</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/d2cml-ai/14.388_r/master?urlpath=tree/_build/jupyter_execute/r_notebook/14_automl_for_wage_prediction.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/d2cml-ai/14.388_r/blob/master/_build/jupyter_execute/r_notebook/14_automl_for_wage_prediction.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/d2cml-ai/14.388_r" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/d2cml-ai/14.388_r/edit/master/_build/jupyter_execute/r_notebook/14_automl_for_wage_prediction.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/d2cml-ai/14.388_r/issues/new?title=Issue%20on%20page%20%2Fr_notebook/14_automl_for_wage_prediction.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/r_notebook/14_automl_for_wage_prediction.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>AutoML for wage prediction</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generating-predictions-using-leader-model">14.1. Generating Predictions Using Leader Model</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="automl-for-wage-prediction">
<h1><span class="section-number">14. </span>AutoML for wage prediction<a class="headerlink" href="#automl-for-wage-prediction" title="Permalink to this heading">#</a></h1>
<p>We illustrate how to predict an outcome variable Y in a high-dimensional setting, using the AutoML package <em>H2O</em> that covers the complete pipeline from the raw dataset to the deployable machine learning model. In last few years, AutoML or automated machine learning has become widely popular among data science community. Again, re-analyse the wage prediction problem using data from the U.S. March Supplement of the Current Population Survey (CPS) in 2015.</p>
<p>We can use AutoML as a benchmark and compare it to the methods that we used in the previous notebook where we applied one machine learning method after the other.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># load the H2O package</span>
<span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;librarian&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">quiet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span>
<span class="n">librarian</span><span class="o">::</span><span class="nf">shelf</span><span class="p">(</span><span class="n">h2o</span><span class="p">,</span><span class="w"> </span><span class="n">tidyverse</span><span class="p">,</span><span class="w"> </span><span class="n">quiet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span>
<span class="c1"># library(h2o)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message in system(&quot;timedatectl&quot;, intern = TRUE):
“running command &#39;timedatectl&#39; had status 1”
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># load the data set</span>

<span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">read_csv</span><span class="p">(</span><span class="s">&quot;https://github.com/alexanderquispe/14.38_Causal_ML/raw/main/data/wage2015_subsample_inference.csv&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">show_col_types</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">F</span><span class="p">)</span>

<span class="c1"># split the data</span>
<span class="nf">set.seed</span><span class="p">(</span><span class="m">1234</span><span class="p">)</span>
<span class="n">training</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="nf">nrow</span><span class="p">(</span><span class="n">data</span><span class="p">),</span><span class="w"> </span><span class="nf">nrow</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="m">3</span><span class="o">/</span><span class="m">4</span><span class="p">),</span><span class="w"> </span><span class="n">replace</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>

<span class="n">train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="n">training</span><span class="p">,]</span>
<span class="n">test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="n">training</span><span class="p">,]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># start h2o cluster</span>
<span class="nf">h2o.init</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>H2O is not running yet, starting it now...

Note:  In case of errors look at the following log files:
    /tmp/Rtmp04tHzQ/file3c5628322d/h2o_UnknownUser_started_from_r.out
    /tmp/Rtmp04tHzQ/file3c7321dc6f/h2o_UnknownUser_started_from_r.err


Starting H2O JVM and connecting: .... Connection successful!

R is connected to the H2O cluster: 
    H2O cluster uptime:         2 seconds 645 milliseconds 
    H2O cluster timezone:       Etc/UTC 
    H2O data parsing timezone:  UTC 
    H2O cluster version:        3.36.1.2 
    H2O cluster version age:    1 month and 23 days  
    H2O cluster name:           H2O_started_from_R_root_tlg556 
    H2O cluster total nodes:    1 
    H2O cluster total memory:   3.17 GB 
    H2O cluster total cores:    2 
    H2O cluster allowed cores:  2 
    H2O cluster healthy:        TRUE 
    H2O Connection ip:          localhost 
    H2O Connection port:        54321 
    H2O Connection proxy:       NA 
    H2O Internal Security:      FALSE 
    R Version:                  R version 4.2.0 (2022-04-22) 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># convert data as h2o type</span>
<span class="n">train_h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.h2o</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
<span class="n">test_h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.h2o</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>

<span class="c1"># have a look at the data</span>
<span class="nf">h2o.describe</span><span class="p">(</span><span class="n">train_h</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  |======================================================================| 100%
  |======================================================================| 100%
</pre></div>
</div>
<div class="output text_html"><table class="dataframe">
<caption>A data.frame: 21 × 11</caption>
<thead>
	<tr><th scope=col>Label</th><th scope=col>Type</th><th scope=col>Missing</th><th scope=col>Zeros</th><th scope=col>PosInf</th><th scope=col>NegInf</th><th scope=col>Min</th><th scope=col>Max</th><th scope=col>Mean</th><th scope=col>Sigma</th><th scope=col>Cardinality</th></tr>
	<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>rownames</td><td>int </td><td>0</td><td>   0</td><td>0</td><td>0</td><td> 10.000000</td><td>3.264300e+04</td><td>1.560586e+04</td><td>9.721144e+03</td><td>NA</td></tr>
	<tr><td>wage    </td><td>real</td><td>0</td><td>   0</td><td>0</td><td>0</td><td>  3.021978</td><td>5.288457e+02</td><td>2.337760e+01</td><td>2.060944e+01</td><td>NA</td></tr>
	<tr><td>lwage   </td><td>real</td><td>0</td><td>   0</td><td>0</td><td>0</td><td>  1.105912</td><td>6.270697e+00</td><td>2.969673e+00</td><td>5.721780e-01</td><td>NA</td></tr>
	<tr><td>sex     </td><td>int </td><td>0</td><td>2115</td><td>0</td><td>0</td><td>  0.000000</td><td>1.000000e+00</td><td>4.523563e-01</td><td>4.977894e-01</td><td>NA</td></tr>
	<tr><td>shs     </td><td>int </td><td>0</td><td>3770</td><td>0</td><td>0</td><td>  0.000000</td><td>1.000000e+00</td><td>2.382185e-02</td><td>1.525136e-01</td><td>NA</td></tr>
	<tr><td>hsg     </td><td>int </td><td>0</td><td>2896</td><td>0</td><td>0</td><td>  0.000000</td><td>1.000000e+00</td><td>2.501295e-01</td><td>4.331435e-01</td><td>NA</td></tr>
	<tr><td>scl     </td><td>int </td><td>0</td><td>2795</td><td>0</td><td>0</td><td>  0.000000</td><td>1.000000e+00</td><td>2.762817e-01</td><td>4.472157e-01</td><td>NA</td></tr>
	<tr><td>clg     </td><td>int </td><td>0</td><td>2646</td><td>0</td><td>0</td><td>  0.000000</td><td>1.000000e+00</td><td>3.148628e-01</td><td>4.645213e-01</td><td>NA</td></tr>
	<tr><td>ad      </td><td>int </td><td>0</td><td>3341</td><td>0</td><td>0</td><td>  0.000000</td><td>1.000000e+00</td><td>1.349042e-01</td><td>3.416654e-01</td><td>NA</td></tr>
	<tr><td>mw      </td><td>int </td><td>0</td><td>2872</td><td>0</td><td>0</td><td>  0.000000</td><td>1.000000e+00</td><td>2.563439e-01</td><td>4.366704e-01</td><td>NA</td></tr>
	<tr><td>so      </td><td>int </td><td>0</td><td>2707</td><td>0</td><td>0</td><td>  0.000000</td><td>1.000000e+00</td><td>2.990678e-01</td><td>4.579089e-01</td><td>NA</td></tr>
	<tr><td>we      </td><td>int </td><td>0</td><td>3034</td><td>0</td><td>0</td><td>  0.000000</td><td>1.000000e+00</td><td>2.143967e-01</td><td>4.104563e-01</td><td>NA</td></tr>
	<tr><td>ne      </td><td>int </td><td>0</td><td>2973</td><td>0</td><td>0</td><td>  0.000000</td><td>1.000000e+00</td><td>2.301916e-01</td><td>4.210099e-01</td><td>NA</td></tr>
	<tr><td>exp1    </td><td>real</td><td>0</td><td>  49</td><td>0</td><td>0</td><td>  0.000000</td><td>4.700000e+01</td><td>1.385590e+01</td><td>1.067133e+01</td><td>NA</td></tr>
	<tr><td>exp2    </td><td>real</td><td>0</td><td>  49</td><td>0</td><td>0</td><td>  0.000000</td><td>2.209000e+01</td><td>3.058340e+00</td><td>4.039614e+00</td><td>NA</td></tr>
	<tr><td>exp3    </td><td>real</td><td>0</td><td>  49</td><td>0</td><td>0</td><td>  0.000000</td><td>1.038230e+02</td><td>8.385453e+00</td><td>1.465866e+01</td><td>NA</td></tr>
	<tr><td>exp4    </td><td>real</td><td>0</td><td>  49</td><td>0</td><td>0</td><td>  0.000000</td><td>4.879681e+02</td><td>2.566770e+01</td><td>5.425545e+01</td><td>NA</td></tr>
	<tr><td>occ     </td><td>int </td><td>0</td><td>   0</td><td>0</td><td>0</td><td> 10.000000</td><td>1.000000e+05</td><td>5.247124e+03</td><td>1.157852e+04</td><td>NA</td></tr>
	<tr><td>occ2    </td><td>int </td><td>0</td><td>   0</td><td>0</td><td>0</td><td>  1.000000</td><td>2.200000e+01</td><td>1.168514e+01</td><td>6.965247e+00</td><td>NA</td></tr>
	<tr><td>ind     </td><td>int </td><td>0</td><td>   0</td><td>0</td><td>0</td><td>370.000000</td><td>1.000000e+05</td><td>6.605252e+03</td><td>5.173314e+03</td><td>NA</td></tr>
	<tr><td>ind2    </td><td>int </td><td>0</td><td>   0</td><td>0</td><td>0</td><td>  2.000000</td><td>2.200000e+01</td><td>1.329777e+01</td><td>5.691808e+00</td><td>NA</td></tr>
</tbody>
</table>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># define the variables</span>
<span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;lwage&#39;</span>
<span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">setdiff</span><span class="p">(</span><span class="nf">names</span><span class="p">(</span><span class="n">data</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;wage&#39;</span><span class="p">,</span><span class="s">&#39;occ2&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;ind2&#39;</span><span class="p">))</span>
<span class="w">            </span>
<span class="c1"># run AutoML for 10 base models and a maximal runtime of 100 seconds</span>
<span class="n">aml</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">h2o.automl</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="p">,</span>
<span class="w">                  </span><span class="n">training_frame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">train_h</span><span class="p">,</span>
<span class="w">                  </span><span class="n">leaderboard_frame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">test_h</span><span class="p">,</span>
<span class="w">                  </span><span class="n">max_models</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">,</span>
<span class="w">                  </span><span class="n">seed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span>
<span class="w">                  </span><span class="n">max_runtime_secs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span>
<span class="w">                 </span><span class="p">)</span>
<span class="c1"># AutoML Leaderboard</span>
<span class="n">lb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aml</span><span class="o">@</span><span class="n">leaderboard</span>
<span class="nf">print</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">nrow</span><span class="p">(</span><span class="n">lb</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message in .verify_dataxy(training_frame, x, y):
“removing response variable from the explanatory variables”
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  |======================================================================| 100%
                                                  model_id      rmse       mse
1     StackedEnsemble_AllModels_1_AutoML_1_20220719_171824 0.4669942 0.2180836
2  StackedEnsemble_BestOfFamily_1_AutoML_1_20220719_171824 0.4690110 0.2199713
3                           GBM_1_AutoML_1_20220719_171824 0.4709260 0.2217713
4                           GBM_2_AutoML_1_20220719_171824 0.4724988 0.2232551
5                           GBM_3_AutoML_1_20220719_171824 0.4733774 0.2240862
6                           GBM_4_AutoML_1_20220719_171824 0.4740358 0.2247100
7                       XGBoost_3_AutoML_1_20220719_171824 0.4791050 0.2295416
8                           XRT_1_AutoML_1_20220719_171824 0.4884560 0.2385893
9                           DRF_1_AutoML_1_20220719_171824 0.4893117 0.2394260
10                      XGBoost_2_AutoML_1_20220719_171824 0.5039629 0.2539786
11                      XGBoost_1_AutoML_1_20220719_171824 0.5065185 0.2565610
12                          GLM_1_AutoML_1_20220719_171824 0.5159068 0.2661599
         mae     rmsle mean_residual_deviance
1  0.3479339 0.1176141              0.2180836
2  0.3495583 0.1182146              0.2199713
3  0.3513555 0.1186738              0.2217713
4  0.3540236 0.1189309              0.2232551
5  0.3518737 0.1190304              0.2240862
6  0.3529919 0.1193677              0.2247100
7  0.3582960 0.1207383              0.2295416
8  0.3666487 0.1229990              0.2385893
9  0.3663660 0.1233622              0.2394260
10 0.3757325 0.1267305              0.2539786
11 0.3788916 0.1275746              0.2565610
12 0.3932883 0.1298952              0.2661599

[12 rows x 6 columns] 
</pre></div>
</div>
</div>
</div>
<p>We see that two Stacked Ensembles are at the top of the leaderboard. Stacked Ensembles often outperform a single model. The out-of-sample (test) MSE of the leading model is given by</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">aml</span><span class="o">@</span><span class="n">leaderboard</span><span class="o">$</span><span class="n">mse</span><span class="p">[</span><span class="m">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        mse
1 0.2180836

[1 row x 1 column] 
</pre></div>
</div>
</div>
</div>
<p>The in-sample performance can be evaluated by</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">aml</span><span class="o">@</span><span class="n">leader</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model Details:
==============

H2ORegressionModel: stackedensemble
Model ID:  StackedEnsemble_AllModels_1_AutoML_1_20220719_171824 
Number of Base Models: 10

Base Models (count by algorithm type):

    drf     gbm     glm xgboost 
      2       4       1       3 

Metalearner:

Metalearner algorithm: glm
Metalearner cross-validation fold assignment:
  Fold assignment scheme: AUTO
  Number of folds: 5
  Fold column: NULL
Metalearner hyperparameters: 


H2ORegressionMetrics: stackedensemble
** Reported on training data. **

MSE:  0.1415518
RMSE:  0.3762337
MAE:  0.2857554
RMSLE:  0.09723326
Mean Residual Deviance :  0.1415518



H2ORegressionMetrics: stackedensemble
** Reported on cross-validation data. **
** 5-fold cross-validation on training data (Metrics computed for combined holdout predictions) **

MSE:  0.219355
RMSE:  0.4683535
MAE:  0.3549446
RMSLE:  0.1199425
Mean Residual Deviance :  0.219355


Cross-Validation Metrics Summary: 
                             mean        sd cv_1_valid cv_2_valid cv_3_valid
mae                      0.354820  0.014198   0.347980   0.337307   0.369668
mean_residual_deviance   0.219562  0.023919   0.205474   0.190237   0.236612
mse                      0.219562  0.023919   0.205474   0.190237   0.236612
null_deviance          253.053390 27.814274 228.977890 252.801100 267.446900
r2                       0.327839  0.035450   0.301765   0.389207   0.310545
residual_deviance      169.472760 18.989317 159.447500 154.282040 183.847530
rmse                     0.468019  0.025515   0.453292   0.436161   0.486428
rmsle                    0.119856  0.006879   0.117210   0.110752   0.122937
                       cv_4_valid cv_5_valid
mae                      0.369248   0.349898
mean_residual_deviance   0.249945   0.215545
mse                      0.249945   0.215545
null_deviance          291.623540 224.417530
r2                       0.326576   0.311102
residual_deviance      195.456850 154.329910
rmse                     0.499945   0.464268
rmsle                    0.129307   0.119074
</pre></div>
</div>
</div>
</div>
<p>This is in line with our previous results. To understand how the ensemble works, let’s take a peek inside the Stacked Ensemble “All Models” model.  The “All Models” ensemble is an ensemble of all of the individual models in the AutoML run.  This is often the top performing model on the leaderboard.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">model_ids</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="n">aml</span><span class="o">@</span><span class="n">leaderboard</span><span class="o">$</span><span class="n">model_id</span><span class="p">)[,</span><span class="m">1</span><span class="p">]</span>
<span class="c1"># Get the &quot;All Models&quot; Stacked Ensemble model</span>
<span class="n">se</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">h2o.getModel</span><span class="p">(</span><span class="nf">grep</span><span class="p">(</span><span class="s">&quot;StackedEnsemble_AllModels&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">model_ids</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)[</span><span class="m">1</span><span class="p">])</span>
<span class="c1"># Get the Stacked Ensemble metalearner model</span>
<span class="n">metalearner</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">se</span><span class="o">@</span><span class="n">model</span><span class="o">$</span><span class="n">metalearner_model</span>
<span class="nf">h2o.varimp</span><span class="p">(</span><span class="n">metalearner</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A H2OTable: 10 × 4</caption>
<thead>
	<tr><th scope=col>variable</th><th scope=col>relative_importance</th><th scope=col>scaled_importance</th><th scope=col>percentage</th></tr>
	<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>GBM_1_AutoML_1_20220719_171824    </td><td>0.092798688</td><td>1.00000000</td><td>0.276345757</td></tr>
	<tr><td>GBM_2_AutoML_1_20220719_171824    </td><td>0.089138567</td><td>0.96055849</td><td>0.265446264</td></tr>
	<tr><td>XGBoost_3_AutoML_1_20220719_171824</td><td>0.054892909</td><td>0.59152678</td><td>0.163465916</td></tr>
	<tr><td>GBM_3_AutoML_1_20220719_171824    </td><td>0.034995779</td><td>0.37711503</td><td>0.104214137</td></tr>
	<tr><td>GBM_4_AutoML_1_20220719_171824    </td><td>0.032231744</td><td>0.34732974</td><td>0.095983101</td></tr>
	<tr><td>XGBoost_2_AutoML_1_20220719_171824</td><td>0.016404439</td><td>0.17677447</td><td>0.048850875</td></tr>
	<tr><td>XGBoost_1_AutoML_1_20220719_171824</td><td>0.012321778</td><td>0.13277965</td><td>0.036693094</td></tr>
	<tr><td>GLM_1_AutoML_1_20220719_171824    </td><td>0.003022545</td><td>0.03257099</td><td>0.009000855</td></tr>
	<tr><td>XRT_1_AutoML_1_20220719_171824    </td><td>0.000000000</td><td>0.00000000</td><td>0.000000000</td></tr>
	<tr><td>DRF_1_AutoML_1_20220719_171824    </td><td>0.000000000</td><td>0.00000000</td><td>0.000000000</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>The table above gives us the variable importance of the metalearner in the ensemble. The AutoML Stacked Ensembles use the default metalearner algorithm (GLM with non-negative weights), so the variable importance of the metalearner is actually the standardized coefficient magnitudes of the GLM.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">h2o.varimp_plot</span><span class="p">(</span><span class="n">metalearner</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/32029cc72f2a0f807746f6d9c0e4c9aa611e3d45f5eca15540d4cce6bf892d49.png" src="../_images/32029cc72f2a0f807746f6d9c0e4c9aa611e3d45f5eca15540d4cce6bf892d49.png" />
</div>
</div>
<section id="generating-predictions-using-leader-model">
<h2><span class="section-number">14.1. </span>Generating Predictions Using Leader Model<a class="headerlink" href="#generating-predictions-using-leader-model" title="Permalink to this heading">#</a></h2>
<p>We can also generate predictions on a test sample using the leader model object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">pred</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.matrix</span><span class="p">(</span><span class="nf">h2o.predict</span><span class="p">(</span><span class="n">aml</span><span class="o">@</span><span class="n">leader</span><span class="p">,</span><span class="n">test_h</span><span class="p">))</span><span class="w"> </span><span class="c1"># make prediction using x data from the test sample</span>
<span class="nf">head</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  |======================================================================| 100%
</pre></div>
</div>
<div class="output text_html"><table class="dataframe">
<caption>A matrix: 6 × 1 of type dbl</caption>
<thead>
	<tr><th scope=col>predict</th></tr>
</thead>
<tbody>
	<tr><td>3.028706</td></tr>
	<tr><td>2.533245</td></tr>
	<tr><td>2.823822</td></tr>
	<tr><td>2.470121</td></tr>
	<tr><td>2.776539</td></tr>
	<tr><td>2.678759</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>This allows us to estimate the out-of-sample (test) MSE and the standard error as well.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">y_test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.matrix</span><span class="p">(</span><span class="n">test_h</span><span class="o">$</span><span class="n">lwage</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="nf">lm</span><span class="p">((</span><span class="n">y_test</span><span class="o">-</span><span class="n">pred</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="o">~</span><span class="m">1</span><span class="p">))</span><span class="o">$</span><span class="n">coef</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>0.218083617310276</li><li>0.0149540081481586</li></ol>
</div></div>
</div>
<p>We observe both a lower MSE and a lower standard error compared to our previous results (see <a class="reference external" href="https://www.kaggle.com/janniskueck/pm3-notebook-newdata">here</a>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">h2o.shutdown</span><span class="p">(</span><span class="n">prompt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">F</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "d2cml-ai/14.388_r",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            name: "ir",
            path: "./r_notebook"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="13_deep_neural_networks_for_wage_prediction.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">13. </span>Deep Neural Networks for Wage Prediction</p>
      </div>
    </a>
    <a class="right-next"
       href="15_functional_approximation_by_nn_and_rf.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">15. </span>Functional Approximation By NN and RF</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generating-predictions-using-leader-model">14.1. Generating Predictions Using Leader Model</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Victor Chernozhukov & Jannis Kueck. Jupyter book created by Alexander Quispe
</p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>